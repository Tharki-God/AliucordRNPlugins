(function(swcHelpers,entities,Metro){'use strict';function _interopNamespace(e){if(e&&e.__esModule)return e;var n=Object.create(null);if(e){Object.keys(e).forEach(function(k){if(k!=='default'){var d=Object.getOwnPropertyDescriptor(e,k);Object.defineProperty(n,k,d.get?d:{enumerable:true,get:function(){return e[k]}});}})}n["default"]=e;return Object.freeze(n)}var swcHelpers__namespace=/*#__PURE__*/_interopNamespace(swcHelpers);var Metro__namespace=/*#__PURE__*/_interopNamespace(Metro);var isObject=testMaterial=>typeof testMaterial==="object"&&!Array.isArray(testMaterial)&&testMaterial!=null;var prototypeChecker=(ModuleExports,Protos)=>isObject(ModuleExports)&&Protos.every(p=>Object.values(ModuleExports).some(m=>m?.prototype?.[p]));var{UnsyncedUserSettingsStore,ThemeStore,GuildMemberStore}=Metro__namespace;var ThemeColorMap=Metro__namespace.getByProps("CHAT_BACKGROUND");var{default:GuildPrototype}=Metro__namespace.getModule(m=>prototypeChecker(m,["getRole","getIconURL"]));var defaultSettings={colorThreshold:30,percentage:40,shouldPatchRole:false};var PluginInstance=()=>ShowNames.instance;var getBackgroundColor=()=>{var ChatBackgroundColorMap=ThemeColorMap.CHAT_BACKGROUND;var{theme}=ThemeStore;var{useAMOLEDTheme}=UnsyncedUserSettingsStore;switch(true){case theme=="dark"&&useAMOLEDTheme!==2:return ChatBackgroundColorMap[0];case theme=="dark"||useAMOLEDTheme==2:return ChatBackgroundColorMap[2];case theme=="light":return ChatBackgroundColorMap[1]}};var LightenDarkenColor=(color1,amount)=>{return `#${color1.replace(/^#/,"").replace(/../g,color=>`0${Math.min(255,Math.max(0,parseInt(color,16)+amount)).toString(16)}`.substr(-2))}`};var makeColorVisible=(color,precent)=>{var{theme}=ThemeStore;switch(theme){case"light":return LightenDarkenColor(color,-precent);case"dark":return LightenDarkenColor(color,precent);default:PluginInstance().logger.error("Unknown theme detected. Contact the developer for help!");}};var getDifference=(color1,color2)=>{if(!color1&&!color2)return;color1=color1.substring(1,7);color2=color2.substring(1,7);var _r=parseInt(color1.substring(0,2),16);var _g=parseInt(color1.substring(2,4),16);var _b=parseInt(color1.substring(4,6),16);var __r=parseInt(color2.substring(0,2),16);var __g=parseInt(color2.substring(2,4),16);var __b=parseInt(color2.substring(4,6),16);var _p1=_r/255*100;var _p2=_g/255*100;var _p3=_b/255*100;var perc1=Math.round((_p1+_p2+_p3)/3);var __p1=__r/255*100;var __p2=__g/255*100;var __p3=__b/255*100;var perc2=Math.round((__p1+__p2+__p3)/3);return Math.abs(perc1-perc2)};var{FormRow,FormSection,FormIcon,FormText}=Metro.Forms;var{ScrollView,View}=Metro.ReactNative;var styles=Metro.Styles.createThemedStyleSheet({description:{marginLeft:12,marginRight:12,color:Metro.Styles.ThemeColorMap.TEXT_NORMAL},title:{fontSize:16,color:Metro.Styles.ThemeColorMap.TEXT_NORMAL,fontFamily:Metro.Constants.Fonts.PRIMARY_BOLD,marginBottom:10}});var SettingsPage=()=>{return Metro.React.createElement(Metro.React.Fragment,null,Metro.React.createElement(ScrollView,null,Metro.React.createElement(FormSection,{title:"Custom Background",android_noDivider:true},Metro.React.createElement(View,swcHelpers__namespace.extends({},{style:styles.title}),Metro.React.createElement(FormText,{style:styles.title},"Test Settings")))))};var ShowNames=function(Plugin1){swcHelpers__namespace.inherits(ShowNames,Plugin1);var _super=swcHelpers__namespace.createSuper(ShowNames);function ShowNames(manifest){swcHelpers__namespace.classCallCheck(this,ShowNames);var _this;_this=_super.call(this,manifest);ShowNames.instance=swcHelpers__namespace.assertThisInitialized(_this);return _this}var _proto=ShowNames.prototype;_proto.start=function start(){this.applyPatches();};_proto.applyPatches=function applyPatches(){this.patcher.after(GuildMemberStore,"getMember",(ctx,component)=>{this.changeColor(component);});this.patcher.after(GuildPrototype.prototype,"getRole",(ctx,component)=>{this.changeColor(component);});};_proto.changeColor=function changeColor(item){if(!item?.colorString)return;var backgroundColor=getBackgroundColor();var difference=getDifference(backgroundColor,item.colorString);if(difference>this.settings.get("colorThreshold",defaultSettings.colorThreshold))return;var changePercent=Math.floor((this.settings.get("percentage",defaultSettings.percentage)-difference)/100*255);item.colorString=makeColorVisible(item.colorString,changePercent);};_proto.stop=function stop(){this.patcher.unpatchAll();};_proto.getSettingsPage=function getSettingsPage(){return React.createElement(SettingsPage,null)};return ShowNames}(swcHelpers__namespace.wrapNativeSuper(entities.Plugin));return ShowNames;})(swcHelpers,globalThis.aliucord.entities,globalThis.aliucord.metro);